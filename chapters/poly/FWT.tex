\section{FWT}

\begin{minted}{c++}
void FWTor(int a[], int op) {
    for (int l = 2; l <= n; l <<= 1)
        for (int i = 0; i < n; i += l)
            for (int j = 0; j < l / 2; j++)
                a[i + j + l / 2] = (a[i + j + l / 2] + (long long)a[i + j] * op % mod + mod) % mod;
    return;
}
void FWTand(int a[], int op) {
    for (int l = 2; l <= n; l <<= 1)
        for (int i = 0; i < n; i += l)
            for (int j = 0; j < l / 2; j++)
                a[i + j] = (a[i + j] + (long long)a[i + j + l / 2] * op % mod + mod) % mod;
    return;
}
void FWTxor(int a[], int op) {
    for (int l = 2; l <= n; l <<= 1)
        for (int i = 0; i < n; i += l)
            for (int j = 0; j < l / 2; j++) {
                int p = (a[i + j] + a[i + j + l / 2]) % mod, d = (a[i + j] - a[i + j + l / 2] + mod) % mod;
                a[i + j] = (long long)p * op % mod;
                a[i + j + l / 2] = (long long)d * op % mod;
            }
    return;
}
\end{minted}